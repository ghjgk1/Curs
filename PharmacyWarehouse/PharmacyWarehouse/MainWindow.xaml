<Window x:Class="PharmacyWarehouse.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:PharmacyWarehouse"
        mc:Ignorable="d" 
        Height="950" Width="1500"
        Title="MainWindow" >
    <Grid>
        <Grid.RowDefinitions>
            <!-- Шапка -->
            <RowDefinition Height="Auto"/>
            <!-- Контент -->
            <RowDefinition Height="*"/>
            <!-- Статус бар -->
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Border Grid.Row="0" 
            Background="{StaticResource PrimaryBrush}" 
            Padding="16">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Название -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="🏥" FontSize="28" VerticalAlignment="Center" Margin="0,0,12,0"/>
                    <StackPanel>
                        <TextBlock Text="PHARMACY WAREHOUSE" 
                              Style="{StaticResource H2}"
                              Foreground="{StaticResource TextWhiteBrush}"
                              Margin="0"/>
                        <TextBlock Text="Система управления складом лекарственных препаратов"
                              Style="{StaticResource Caption}"
                              Foreground="{StaticResource GrayLighterBrush}"/>
                    </StackPanel>
                </StackPanel>

                <!-- Быстрые действия -->
                <StackPanel Grid.Column="1" 
                       Orientation="Horizontal" 
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center">

                    <Button Style="{StaticResource OutlineButton}"
                        Foreground="{StaticResource TextWhiteBrush}"
                        BorderBrush="{StaticResource GrayLighterBrush}"
                        Margin="8,0"  Click="Receipt_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="📦" Margin="0,0,6,0"/>
                            <TextBlock Text="Прием товара"/>
                        </StackPanel>
                    </Button>

                    <Button Style="{StaticResource OutlineButton}"
                        Foreground="{StaticResource TextWhiteBrush}"
                        BorderBrush="{StaticResource GrayLighterBrush}"
                        Margin="8,0" Click="WriteOff_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="💰" Margin="0,0,6,0"/>
                            <TextBlock Text="Продажа"/>
                        </StackPanel>
                    </Button>

                    <Button Style="{StaticResource OutlineButton}"
                        Foreground="{StaticResource TextWhiteBrush}"
                        BorderBrush="{StaticResource GrayLighterBrush}"
                        Margin="8,0" Click="Inventory_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="📋" Margin="0,0,6,0"/>
                            <TextBlock Text="Инвентаризация"/>
                        </StackPanel>
                    </Button>

                    <!-- Поиск -->
                    <Border Background="{StaticResource PrimaryLightBrush}"
                        CornerRadius="20"
                        Padding="12,8"
                        Margin="20,0,0,0"
                        Width="300">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="🔍" 
                                  VerticalAlignment="Center"
                                  Margin="0,0,8,0"
                                  Foreground="{StaticResource GrayLighterBrush}"/>
                            <TextBox Text="Поиск товаров..." 
                                x:Name="SearchTextBox"
                                BorderThickness="0"
                                KeyDown="SearchTextBox_KeyDown"
                                GotFocus="SearchTextBox_GotFocus"
                                LostFocus="SearchTextBox_LostFocus"
                                Background="Transparent"
                                Foreground="{StaticResource TextWhiteBrush}"
                                VerticalAlignment="Center"
                                Width="220">
                                <TextBox.Style>
                                    <Style TargetType="TextBox" BasedOn="{StaticResource {x:Type TextBox}}">
                                        <Style.Triggers>
                                            <Trigger Property="IsFocused" Value="True">
                                                <Setter Property="Foreground" Value="{StaticResource TextDarkBrush}"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBox.Style>
                            </TextBox>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- Пользователь и уведомления -->
                <StackPanel Grid.Column="2" 
                       Orientation="Horizontal" 
                       VerticalAlignment="Center">

                    <!-- Уведомления -->
                    <Button Style="{StaticResource IconButton}"
                        Margin="0,0,16,0"
                        ToolTip="Уведомления" Click="Notifications_Click">
                        <StackPanel>
                            <TextBlock Text="🔔" FontSize="16"/>
                            <Border Background="{StaticResource AccentRedBrush}"
                                CornerRadius="8"
                                Padding="4,2"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Top"
                                Margin="0,-8,0,0">
                                <TextBlock Text="{Binding NotificationCount}" 
                                      Foreground="White"
                                      FontSize="10"
                                      FontWeight="Bold"/>
                            </Border>
                        </StackPanel>
                    </Button>

                    <!-- Пользователь -->
                    <Border Background="{StaticResource PrimaryLightBrush}"
                        CornerRadius="6"
                        Padding="12,8">
                        <StackPanel Orientation="Horizontal">
                            <Border Background="{StaticResource SecondaryBrush}"
                                CornerRadius="20"
                                Width="32" Height="32"
                                VerticalAlignment="Center">
                                <TextBlock Text="👤" 
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel Margin="12,0,0,0">
                                <TextBlock Text="Иванов А.П."
                                      Foreground="{StaticResource TextWhiteBrush}"
                                      FontWeight="SemiBold"/>
                                <TextBlock Text="Администратор"
                                      Style="{StaticResource Caption}"
                                      Foreground="{StaticResource GrayLighterBrush}"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Grid>
        </Border>

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="240"/>
                <!-- Навигация -->
                <ColumnDefinition Width="*"/>
                <!-- Рабочая область -->
            </Grid.ColumnDefinitions>

            <Border Grid.Column="0" 
                Background="{StaticResource PrimaryDarkBrush}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="0,16,0,0">

                         <!--Справочники--> 
                        <TextBlock Text="Справочники" Style="{StaticResource NavHeader}"/>
                        <Button Style="{StaticResource NavItem}" Click="Products_Click">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="💊" Width="24"/>
                                <TextBlock Text="Товары"/>
                            </StackPanel>
                        </Button>
                        <Button Style="{StaticResource NavItem}" Click="Batches_Click">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="📦" Width="24"/>
                                <TextBlock Text="Партии"/>
                            </StackPanel>
                        </Button>
                        <Button Style="{StaticResource NavItem}" Click="Suppliers_Click">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="🏢" Width="24"/>
                                <TextBlock Text="Поставщики"/>
                            </StackPanel>
                        </Button>
                        <Button Style="{StaticResource NavItem}" Click="Categories_Click">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="📁" Width="24"/>
                                <TextBlock Text="Категории"/>
                            </StackPanel>
                        </Button>

                         <!--Документы--> 
                        <TextBlock Text="Документы" Style="{StaticResource NavHeader}"/>
                        <Button Style="{StaticResource NavItem}" Click="Receipt_Click">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="📥" Width="24"/>
                                <TextBlock Text="Приход"/>
                            </StackPanel>
                        </Button>
                        <Button Style="{StaticResource NavItem}" Click="WriteOff_Click">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="📤" Width="24"/>
                                <TextBlock Text="Списание"/>
                            </StackPanel>
                        </Button>
                        <Button Style="{StaticResource NavItem}" Click="Transfer_Click">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="🔄" Width="24"/>
                                <TextBlock Text="Перемещение"/>
                            </StackPanel>
                        </Button>
                        <Button Style="{StaticResource NavItem}" Click="Documents_Click">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="📋" Width="24"/>
                                <TextBlock Text="Все документы"/>
                            </StackPanel>
                        </Button>

                        <!-- Учет и контроль -->
                        <TextBlock Text="Учет и контроль" Style="{StaticResource NavHeader}"/>
                        <Button Style="{StaticResource NavItem}" Click="Inventory_Click">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="📊" Width="24"/>
                                <TextBlock Text="Инвентаризация"/>
                            </StackPanel>
                        </Button>
                        <Button Style="{StaticResource NavItem}" Click="Stock_Click">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="📈" Width="24"/>
                                <TextBlock Text="Остатки"/>
                            </StackPanel>
                        </Button>
                        <Button Style="{StaticResource NavItem}" Click="ExpirationControl_Click">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="⚠️" Width="24"/>
                                <TextBlock Text="Контроль сроков"/>
                            </StackPanel>
                        </Button>

                        <!-- Отчеты -->
                        <TextBlock Text="Отчеты" Style="{StaticResource NavHeader}"/>
                        <Button Style="{StaticResource NavItem}" Click="MovementReport_Click">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="📊" Width="24"/>
                                <TextBlock Text="Движение товаров"/>
                            </StackPanel>
                        </Button>
                        <Button Style="{StaticResource NavItem}" Click="SalesReport_Click">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="💰" Width="24"/>
                                <TextBlock Text="Продажи"/>
                            </StackPanel>
                        </Button>
                        <Button Style="{StaticResource NavItem}" Click="SupplierReport_Click">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="🏢" Width="24"/>
                                <TextBlock Text="Поставщики"/>
                            </StackPanel>
                        </Button>
                        <Button Style="{StaticResource NavItem}" Click="ExpiredReport_Click">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="⏳" Width="24"/>
                                <TextBlock Text="Просрочка"/>
                            </StackPanel>
                        </Button>

                        <!-- Администрирование -->
                        <TextBlock Text="Администрирование" Style="{StaticResource NavHeader}"/>
                        <Button Style="{StaticResource NavItem}" Click="Backup_Click">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="💾" Width="24"/>
                                <TextBlock Text="Резервная копия"/>
                            </StackPanel>
                        </Button>
                        <Button Style="{StaticResource NavItem}" Click="AuditLog_Click">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="📝" Width="24"/>
                                <TextBlock Text="Журнал действий"/>
                            </StackPanel>
                        </Button>
                        
                    </StackPanel>
                </ScrollViewer>
            </Border>

            <Frame x:Name="MainFrame" 
               Grid.Column="1" 
               NavigationUIVisibility="Hidden"
               Margin="16"/>

        </Grid>

        <StatusBar Grid.Row="2" 
       Background="{StaticResource PrimaryDarkBrush}"
       Foreground="{StaticResource TextWhiteBrush}"
       Height="28">

            <StatusBarItem>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Статус:" Margin="0,0,4,0"/>
                    <TextBlock Text="{Binding Status}" />
                </StackPanel>
            </StatusBarItem>

            <Separator/>

            <StatusBarItem>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="БД:" Margin="8,0,4,0"/>
                    <TextBlock Text="{Binding DbStatus}" />
                </StackPanel>
            </StatusBarItem>

            <Separator/>

            <StatusBarItem>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Пользователь:" Margin="8,0,4,0"/>
                    <TextBlock Text="Иванов А.П."/>
                </StackPanel>
            </StatusBarItem>

            <Separator/>

            <StatusBarItem>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Последнее сохранение:" Margin="8,0,4,0"/>
                    <TextBlock Text="{Binding LastSave}"/>
                </StackPanel>
            </StatusBarItem>

            <Separator/>

            <StatusBarItem HorizontalAlignment="Right">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Товаров в базе:" Margin="0,0,4,0"/>
                    <TextBlock Text="{Binding ProductCount}" FontWeight="SemiBold"/>
                </StackPanel>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
